import numpy as np
import turtle
from cmath import rect, phase
from math import radians, degrees, atan2

x_actual = np.array([0.0, 1.4672214011007085, 2.83753958756461, 4.0510650791270315, 5.054760988665319, 5.80476098866532, 6.268286480227742, 6.4250791751292216, 6.268286480227741, 5.804760988665318, 5.054760988665317, 4.051065079127029, 2.837539587564608, 1.4672214011007072, -8.881784197001252e-16, -1.5000000000000009, -2.9672214011007103, -4.337539587564613, -5.551065079127038, -6.554760988665329, -7.304760988665335, -7.768286480227762, -7.925079175129248, -7.768286480227774, -7.3047609886653575, -6.55476098866536, -5.551065079127074, -4.3375395875646525, -2.9672214011007503, -1.500000000000041, -4.107825191113079e-14, 1.4672214011006668, 2.837539587564567, 4.051065079126986, 5.054760988665272, 5.8047609886652705, 6.268286480227689, 6.4250791751291665, 6.268286480227683, 5.804760988665258, 5.0547609886652545, 4.051065079126965, 2.8375395875645424, 1.4672214011006404, -6.816769371198461e-14, -1.5000000000000682, -2.967221401100777, -4.337539587564679, -5.551065079127102, -6.554760988665391, -7.304760988665395, -7.76828648022782, -7.925079175129303, -7.768286480227826, -7.304760988665407, -6.55476098866541, -5.551065079127124, -4.337539587564702, -2.9672214011008, -1.5000000000000908, -9.08162434143378e-14, 1.467221401100617, 2.837539587564517, 4.0510650791269365, 5.0547609886652225, 5.804760988665221, 6.26828648022764, 6.425079175129117, 6.2682864802276335, 5.804760988665208, 5.054760988665205, 4.051065079126915, 2.8375395875644926, 1.4672214011005906, -1.1790568521519162e-13, -1.500000000000118, -2.9672214011008267, -4.337539587564729, -5.551065079127151, -6.554760988665441, -7.3047609886654445, -7.76828648022787, -7.925079175129353, -7.768286480227876, -7.304760988665457, -6.55476098866546, -5.551065079127174, -4.337539587564752, -2.9672214011008498, -1.5000000000001406, -1.4055423491754482e-13])
y_actual = np.array([10.0, 10.31186753622664, 10.92197250084034, 11.803650379279048, 12.91836761749514, 14.217405723171797, 15.643990497614528, 17.135773340666937, 18.627556183719346, 20.054140958162076, 21.353179063838734, 22.467896302054825, 23.349574180493534, 23.959679145107234, 24.271546681333874, 24.271546681333877, 23.95967914510724, 23.349574180493544, 22.46789630205484, 21.353179063838752, 20.054140958162098, 18.62755618371937, 17.13577334066696, 15.643990497614551, 14.217405723171819, 12.918367617495159, 11.803650379279066, 10.921972500840356, 10.311867536226657, 10.000000000000021, 10.000000000000025, 10.311867536226666, 10.921972500840369, 11.80365037927908, 12.918367617495173, 14.217405723171833, 15.643990497614563, 17.135773340666972, 18.62755618371938, 20.05414095816211, 21.353179063838766, 22.467896302054854, 23.349574180493562, 23.95967914510726, 24.2715466813339, 24.2715466813339, 23.95967914510726, 23.349574180493562, 22.467896302054854, 21.353179063838766, 20.05414095816211, 18.62755618371938, 17.135773340666972, 15.643990497614562, 14.217405723171831, 12.918367617495171, 11.803650379279079, 10.921972500840369, 10.31186753622667, 10.000000000000034, 10.000000000000037, 10.311867536226679, 10.921972500840381, 11.803650379279093, 12.918367617495186, 14.217405723171845, 15.643990497614576, 17.135773340666987, 18.627556183719395, 20.054140958162126, 21.35317906383878, 22.467896302054868, 23.349574180493576, 23.959679145107273, 24.271546681333913, 24.271546681333913, 23.959679145107273, 23.349574180493576, 22.467896302054868, 21.35317906383878, 20.054140958162126, 18.627556183719395, 17.135773340666987, 15.643990497614576, 14.217405723171845, 12.918367617495186, 11.803650379279093, 10.921972500840383, 10.311867536226684, 10.000000000000048, 10.000000000000052])



# takes degrees in radians and outputs radians
def mean_angle(deg):
    return phase( sum(rect(1, d) for d in deg) / len(deg) )


size_multiplier = 150.
turtle.setup(450, 450, 400, 200)

actual_angles = turtle.Turtle()
actual_angles.shape('circle')
actual_angles.color('black')
actual_angles.penup()
actual_angles.shapesize(0.3, 0.3, 0.3)

circle = turtle.Turtle()
circle.shape('circle')
circle.color('bisque2')
circle.shapesize(0.05, 0.05, 0.05)

faulty_angles_turtle = turtle.Turtle()
faulty_angles_turtle.shape('circle')
faulty_angles_turtle.color('red')
# faulty_angles_turtle.penup()
faulty_angles_turtle.shapesize(0.2, 0.2, 0.2)

average_turtle = turtle.Turtle()
average_turtle.shape('circle')
average_turtle.color('blue')
average_turtle.penup()
average_turtle.shapesize(0.3, 0.3, 0.3)

average_angle_turtle = turtle.Turtle()
average_angle_turtle.shape('square')
average_angle_turtle.color('green')
average_angle_turtle.penup()
average_angle_turtle.shapesize(0.3, 0.3, 0.3)

actual_angle_turtle = turtle.Turtle()
actual_angle_turtle.shape('square')
actual_angle_turtle.color('brown')
actual_angle_turtle.penup()
actual_angle_turtle.shapesize(0.3, 0.3, 0.3)

faulty_angles = [-0.6156182580241034, -0.8020936886770578, -1.8386780417749993, -0.38446882956587913, -0.4546346769646803, -0.5946157268379135, 0.5475689254089287, -0.3351553297357732, 0.14472049931592368, 0.032251706860845, 0.23037064282529407, 0.21419455495177875, 0.7422123416973472, 0.9418943889139264, 1.09498755905663, 1.3969028975773217, 1.681098264213757, 1.9347367633698092, 1.8799702773166027, 2.908632743362128, 2.523244075220367, -2.818404660143888, 3.1224298941595645, -2.883672169949575, 2.893487417641504, -1.6463579411004527, -1.888863147750964, -2.617257576783679, -1.7877181169854541, -2.242087291799633,
                 -2.6086678817252267, -1.2971328816360153, -0.9737272068076912, -0.51303724776011, -0.5400725303157792, -0.3757277303949351, -0.31971507889507933, -0.53589816172925, 0.1785334921457773, -0.06100498289037759, 0.3888225681615527, 1.0954419572266545, 0.9138231955509912, 1.1811708915592725, 1.9202703789093247, 0.6911467285337585, 2.1695864792966635, 1.40583689557889, 1.341648520221435, 3.032385004166464, 2.8994953452798224, 2.45726001898257, -2.9340619237062677, -2.3953742554331754, -2.1540234705105092, -2.3674796629850743, -1.9415133386472458, -1.7879913976191428, -1.9848915897596555, -1.4813615961280693,
                 -1.0722201439222694, -1.8840345866301087, -0.8014054972803066, -0.9226283020159372, -0.16401223016961453, -0.05316902680115909, -0.2514578537213161, 0.2579754666612164, 0.5630348161018972, 0.49302779266477703, 0.9789442403327913, 1.3462230320624586, 1.148218998234487, 1.2448056945782664, 0.964800333784388, 2.272684501823261, 1.5948764836286475, 2.48148618644052, 2.4666380235911056, 2.0366770296759134, 2.760126765412929, 2.8899411071116115, 3.0727171278223615, -2.72322291497424, 3.0373802264439673, -2.703377545358305, -2.700063945988651, -2.1136150785000805, -1.8862869763052412, -1.7497105953431493, -1.7582455516705968, -1.67636044976933, -1.33898418913558, -0.6669191305565185, -0.37611718853871423, -0.7742941298778394, -0.696148869930532, -0.6322959468879166, -0.04237793518666777, 1.304858938853946, 0.6275390032575521, 0.10342439944134663, 1.3940400746725512, 0.8701775910527418, 2.2961952370180345, 1.3056763920749983, 1.5326097505244567, 2.0385778511768002, 2.3408781603565405, 2.253766413823948, 2.6571524980554297, -3.112069745204174, 3.107835469268334, -2.801656437887087, -1.654928520080639, -2.497590277536636, -2.3000019565814753, -2.0962386126713675, -1.2859969816642511, -1.2332893525470219, -0.6912806256349633, -1.2821295786418894, -1.3896000934939892, -0.9536022570669722, -0.9858573003411095, -0.328373812866829, 0.2381557806921082, 1.393366653172107, 0.2615680647006391, 0.7574658776443077, 0.33292267074641524, 0.6515159111251587, -0.06909231169434094, 1.1818022795850496, 1.7098857882205065, 1.2865061116192615, 2.0304490670592514, 2.8815572411516444, 2.04864158038977, 2.432509150369622, 3.0456045643098317, 2.4452817315710007, -2.636848685208891, -2.436666523697988, 2.865790772529186, -1.7217380476021509, 2.7300884790016955, -2.0939191862327675, -0.7008511996104367, -1.9480153942660543, -0.679918828920453, -1.9656156976964043, -0.9366159947851536, -0.23750144838517961, -0.6131319662465291, -0.38953536565825075, 0.06573226340579819, 0.25626463665237553, 0.14775950779197178, 0.9558769722608202, 0.719898187124774, 0.8504836743758375, 0.7403579159237719, 1.597201908473421, 1.65926028302448, 0.42765318657317897, 2.3965590799498475, 1.6494051687632734, 2.2732760806909322, 3.0441553713972134, 2.262459579264192, 2.8853368207437073, 2.0352600662829854, 3.0155168602624283, -3.012725028571106, -2.2857800951050473, -2.2713611173083823, -2.343576058121533, -1.8459835105401536, -1.9605699558890173, -1.0178013975801843, -1.2724724462413697, -0.1767814858872221, -1.2064287938746823, -1.206913366945658, -1.2932587165459637, -0.11065187517137431, -0.007835119557826786, -0.08402348797164905, 0.4078341518894053, 0.050245664881232166, 0.7983315964437065, 1.543864650367599, 1.1568335693535943, 1.5981273982905186, 1.6496436163571726, 2.214032669658902, 2.1603570333675925, 2.8210125155638828, 2.669759692411745, 1.9800425032223332, 2.0699485053734454, -2.7280715235314306, -2.549511667134291, -2.3670220260925703, -2.2682568169971606, -2.5830510809666745, -2.3207776723868996, -2.979819400078515, -1.4060830706815004, -1.6826356371056175, -0.4932046479900123, -0.8883044656042749, -0.6328604001460398, -0.6120957774138738, 0.051049079279087195, -0.06722275160168856, -0.22525096990439586, 1.1954476661894118, 0.40372285169455546, 0.6311162286365404, 1.4703720944082885, 0.9610789382966196, 2.9438059435159225, 1.2322353665730548, 1.0111326178355053, 2.0805228282403423, 2.360896394043964, 1.7381980142529967, -2.9608657698197947, 2.541096728777614, 2.5777834302459617, -2.9807082042785513, -2.7065316965392228, -2.8498306694613875, -2.4542378891648653, -1.5407512890898776, -2.048609165922765, -2.0853267586458326, -1.6912830287551541, -1.8116989768930756, -1.0965429051247177, 0.05374796689202599, -0.5695727884551367, -0.9216520005693312, -0.32860150418943945, 0.23579796526013874, 0.16849619772914082, 0.23305983958396936, 0.46420543205892084, 0.8754786254417226, 0.5741176679352136, 0.9751739392672816, 0.8992335747995908, 1.7135162715855836, 2.204825712548063, 1.61126612306313, 2.956656629908739, 2.0169565547984334, 2.79635296454288, -2.961636792053733, 2.5213531023479607, 2.3505741250164798, -3.1284635643799854, 3.1341084507743844, -2.542236735937953, -2.397612354177509, -2.03946120838636, -2.105412130269399, -1.5428555678690516, -1.354353421198816, -1.5517014899884325, -0.45269246555354314, -0.7347635790531974, -0.5506817610733439, 0.0007952616333026796, -0.13798318229629913, -0.4154350030495131, 0.2666237918332697, 1.8946832926775867, 0.26133684559948733, 1.2718787262656548, 1.3076725279710635, 2.34384018170869, 1.9324192224970327, 1.868524523002896, 1.6875586979614576, 1.7120825189388231, 2.1834630581232046, 1.8733203920091581, 2.9835138938356174, -2.920193490013272, -2.3370965160209014, 2.8784873862809324, -2.441072365839685, -2.9051177578574663, -2.2013934350731326, -1.7252812339115948, -1.651482778944942, -1.6034112554841853]

angles = []

for i in range(30):
    angles.append([])

for i in range(len(faulty_angles)):
    index = i % 30
    angles[index].append(faulty_angles[i])




average_angles = []



for i in range(360):
    angle = radians(i)
    x = np.cos(angle)
    y = np.sin(angle)

    if i % 30 == 0:
        circle.goto(x * size_multiplier, y * size_multiplier)
        circle.stamp()


actual_angles.goto( np.cos(-1.46607657168) * size_multiplier, np.sin(-1.46607657168) * size_multiplier)
actual_angles.stamp()

for i in range(30):
    ma = mean_angle(angles[i])
    average_angles.append(ma)
    average_angle_turtle.goto( np.cos(ma) * size_multiplier,
                               np.sin(ma) * size_multiplier)
    average_angle_turtle.stamp()

average_turtle.goto( np.cos(mean_angle(average_angles)) * size_multiplier,
                           np.sin(mean_angle(average_angles)) * size_multiplier)
average_turtle.stamp()




turtle.getscreen()._root.mainloop()



